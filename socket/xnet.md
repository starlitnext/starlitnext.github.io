* kcp包体格式：
```
0                      4     5     6          8  (BYTE)
+----------------------+-----+-----+----------+
|       conv           | cmd | frg |   wnd    |
+----------------------+-----+-----+----------+ 8
|        ts            |           sn         |
+----------------------+----------------------+ 16
|       una            |          len         |
+---------------------------------------------+ 24
|                                             |
|                DATA(optional)               |
|                                             |
+---------------------------------------------+
```
* xnet 包体格式
```
header:
0                                 14                                  28  (BIT)
+----------------------------------+----------------------------------+
|                wnd               |                 una              |
+----------------------------------+----------------------------------+

ACK:
0   1    3         8               14  (BIT)
+---+----+
|   cmd  |
+--------+-------------------------+
|               sn                 |
+---+------------------------------+
|has|
+---+--------------+
|       -count     |
+------------------+

PUSH:
0        3         8               14                                 28  (BIT)
+--------+
|   cmd  |
+------------------+
|       frag       |
+------------------+---------------+----------------------------------+
|                  sn              |                len               |
+---------------------------------------------------------------------+
|                                                                     |
|                                 DATA                                |
|                                                                     |
+---------------------------------------------------------------------+

WASK:
0        3  (BIT)
+--------+
|   cmd  |
+--------+

WINS:
0        3  (BIT)
+--------+
|   cmd  |
+--------+

FIN:
0        3  (BIT)
+--------+
|   cmd  |
+--------+

整包格式
    14          28             39+         18+        3         3         3       (BIT)
+--------+--------------+--------------+---------+---------+---------+---------+
|   sn   |    header    |    -PUSH     |  -ACK   |  -WINS  |  -WASK  |   FIN   |
+--------+--------------+--------------+---------+---------+---------+---------+
```

* xnet优化总结：
    - 把kcp的包按照bit流的方式进行拆分，减小包头大小
    - 不必要的数据可以不放在包头中，比如只有一个WASK的包，则xnet的整包大小会非常小（14+28+3bit = 5.625byte，字节对齐以后6byte），而kcp依然需要24byte来封装这个包
    - 整包和包体中的内容建立sn的映射关系，发送端进行缓存，因此包体内不必带ts来计算rtt
    - 一个update期间内，对于数据量特别小的包，可以合并到一个整包发送，不需要每个数据包都带一整个包头，实际上是重复的
    - ACK合批&合包优化，用一个bit的`has`来表示是否有多个ACK，kcp是每个ACK都要发一个包，而xnet对于序号连续的ACK，合批称一个包，has为true时表示[sn, sn+count)范围内序号的包已经收到
    - xnet进行冗余发送ACK，因为丢包情况下，丢的可能是ACK包，导致发送端认为接收端没有收到数据，导致重发或者等待，xnet会缓存上一帧产生的产生的ACK，下一帧合起来再发送一次
    - 支持不可靠数据包，上层接口调用时制定reliable为false，则这个包不会重发，发送端默认为对方已收到，主要用于做位置同步，客户端可以预测，且逻辑层每帧都发送，表现上不会出问题，且能保证上层最快时间到达（接收端依然能保序）
    - 支持多通道，创建多个xnet对象作为多条链接，每条链接就是一个通道，底层进行链接的管理

* 测试结论
    - 丢包率<30的情况下，延迟和kcp差不多，流量优化20~30%
    - 丢包率>30的情况下，延迟优化20~30%，流量优化30~40%
    - 丢包率越大流量优化越显著